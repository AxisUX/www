<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.7.3">Jekyll</generator><link href="https://www.axisux.com/feed.xml" rel="self" type="application/atom+xml" /><link href="https://www.axisux.com/" rel="alternate" type="text/html" /><updated>2018-06-07T01:57:27-05:00</updated><id>https://www.axisux.com/</id><title type="html">Axis User Experience</title><subtitle>AxisUX is a digital branding agency focused on intersectional design and holistic systems engineering.</subtitle><entry><title type="html">Syntax Highlighting for Liquid Snippet</title><link href="https://www.axisux.com/fieldnotes/engineering/development/2018/06/06/syntax-highlighting-for-liquid-snippet.html" rel="alternate" type="text/html" title="Syntax Highlighting for Liquid Snippet" /><published>2018-06-06T00:00:00-05:00</published><updated>2018-06-06T00:00:00-05:00</updated><id>https://www.axisux.com/fieldnotes/engineering/development/2018/06/06/syntax-highlighting-for-liquid-snippet</id><content type="html" xml:base="https://www.axisux.com/fieldnotes/engineering/development/2018/06/06/syntax-highlighting-for-liquid-snippet.html">&lt;h1 id=&quot;problem&quot;&gt;Problem:&lt;/h1&gt;
&lt;p&gt;Liquid Engine attempts to parse code snippet contained within a markdown code block.&lt;/p&gt;

&lt;h1 id=&quot;reported-errors&quot;&gt;Reported Errors:&lt;/h1&gt;
&lt;p&gt;rendered code snippet is missing any code with enclosing liquid syntax braces&lt;/p&gt;

&lt;p&gt;Example Input Code:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;{% highlight html %}
    {%- if page.author -%}
        • &lt;span class=&quot;nt&quot;&gt;&amp;lt;span&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;itemprop=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;author&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;itemscope&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;itemtype=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://schema.org/Person&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;span&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;p-author h-card&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;itemprop=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;{{ page.author }}&lt;span class=&quot;nt&quot;&gt;&amp;lt;/span&amp;gt;&amp;lt;/span&amp;gt;&lt;/span&gt;
    {%- endif -%}&lt;span class=&quot;nt&quot;&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;
{% endhighlight %}&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Example Output&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;• &lt;span class=&quot;nt&quot;&gt;&amp;lt;span&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;itemprop=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;author&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;itemscope&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;itemtype=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://schema.org/Person&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;span&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;p-author h-card&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;itemprop=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;David Midlo&lt;span class=&quot;nt&quot;&gt;&amp;lt;/span&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/p&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;ul&gt;
  &lt;li&gt;The &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;span&amp;gt;&lt;/code&gt; example above is actually enclosed with an &lt;code class=&quot;highlighter-rouge&quot;&gt;{%- if -%}{%- endif -%}&lt;/code&gt; statement but is not showing up.&lt;/li&gt;
  &lt;li&gt;The above example also unwantedly renders the post author &lt;code class=&quot;highlighter-rouge&quot;&gt;David Midlo&lt;/code&gt; when in actuallity &lt;code class=&quot;highlighter-rouge&quot;&gt;{{ page.author }}&lt;/code&gt; was the desired text for the code snippet.&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;solution&quot;&gt;Solution:&lt;/h1&gt;
&lt;p&gt;Use of the &lt;code class=&quot;highlighter-rouge&quot;&gt;{% raw %}&lt;/code&gt; declaration solves this problem by directing liquid to parse the enclosed text as raw text instead of a liquid declaration&lt;/p&gt;

&lt;p&gt;Solution Code:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;{% highlight html %}
{% raw %}
   {%- if page.author -%}
        • &lt;span class=&quot;nt&quot;&gt;&amp;lt;span&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;itemprop=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;author&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;itemscope&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;itemtype=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://schema.org/Person&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;span&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;p-author h-card&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;itemprop=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;{{ page.author }}&lt;span class=&quot;nt&quot;&gt;&amp;lt;/span&amp;gt;&amp;lt;/span&amp;gt;&lt;/span&gt;
    {%- endif -%}&lt;span class=&quot;nt&quot;&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;
{% endraw %}
{% endhighlight %}    &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h1 id=&quot;attempted-solutions&quot;&gt;Attempted Solutions:&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;For a line-by-line solution, escape the beginning &lt;code class=&quot;highlighter-rouge&quot;&gt;{%-&lt;/code&gt; tag by wrapping a &lt;code class=&quot;highlighter-rouge&quot;&gt;{{ &quot;&amp;lt;content&amp;gt;&quot; }}&lt;/code&gt; block around it. &lt;em&gt;The closing tag does not need to be escaped as it is ignored by the liquid parser.&lt;/em&gt;
    &lt;ul&gt;
      &lt;li&gt;So &lt;code class=&quot;highlighter-rouge&quot;&gt;{%- if page.author -%}&lt;/code&gt; becomes &lt;code class=&quot;highlighter-rouge&quot;&gt;{{ &quot;{%-&quot; }} if page.author -%}&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;and &lt;code class=&quot;highlighter-rouge&quot;&gt;{%- endif -%}&lt;/code&gt; becomes &lt;code class=&quot;highlighter-rouge&quot;&gt;{{ &quot;{%-&quot; }} endif -%}&lt;/code&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;additonal-notes&quot;&gt;Additonal Notes:&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;The line-by-line technique was used to present the solution code above. This was used here because liquid has trouble with nested &lt;code class=&quot;highlighter-rouge&quot;&gt;{% raw %}&lt;/code&gt; tags.&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;references&quot;&gt;References:&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/19996881/is-there-no-parse-block-for-liquid&quot;&gt;Is there “no-parse” block for Liquid?&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;possible-enhancements&quot;&gt;Possible Enhancements:&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;It would also be reasonable to use an embed like github gists or something similar.&lt;/li&gt;
&lt;/ul&gt;</content><author><name>David Midlo</name></author><category term="jekyll" /><category term="post" /><category term="liquid" /><category term="syntax highlighting" /><category term="code block" /><summary type="html">Problem: Liquid Engine attempts to parse code snippet contained within a markdown code block.</summary></entry><entry><title type="html">Add Author to Jekyll Post</title><link href="https://www.axisux.com/fieldnotes/engineering/development/2018/06/06/add-author-to-jekyll-post.html" rel="alternate" type="text/html" title="Add Author to Jekyll Post" /><published>2018-06-06T00:00:00-05:00</published><updated>2018-06-06T00:00:00-05:00</updated><id>https://www.axisux.com/fieldnotes/engineering/development/2018/06/06/add-author-to-jekyll-post</id><content type="html" xml:base="https://www.axisux.com/fieldnotes/engineering/development/2018/06/06/add-author-to-jekyll-post.html">&lt;h1 id=&quot;problem&quot;&gt;Problem:&lt;/h1&gt;
&lt;p&gt;Author should be listed on post in Jekyll.&lt;/p&gt;

&lt;h1 id=&quot;reported-errors&quot;&gt;Reported Errors:&lt;/h1&gt;
&lt;p&gt;Author attribution not listed along with post in default jekyll theme (minima)&lt;/p&gt;

&lt;h1 id=&quot;solution&quot;&gt;Solution:&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;Ensure YAML front-matter of post includes the &lt;code class=&quot;highlighter-rouge&quot;&gt;author&lt;/code&gt; tag.&lt;/li&gt;
&lt;/ul&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-yml&quot; data-lang=&quot;yml&quot;&gt;&lt;span class=&quot;nn&quot;&gt;---&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;layout&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;post&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Add Author to Jekyll Post&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;author&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;David Midlo&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;tags&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;jekyll&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;front matter&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;categories&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;field notes&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;Engineering&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;Development&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nn&quot;&gt;---&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h1 id=&quot;attempted-solutions&quot;&gt;Attempted Solutions:&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;To no effect, On first attempt I used an upper-case &lt;code class=&quot;highlighter-rouge&quot;&gt;Author:&lt;/code&gt; within the front-matter to declare the author attribute.  Front-matter requires lower-case ‘author:’&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;additonal-notes&quot;&gt;Additonal Notes:&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;The conditional for whethor or not to include the author attribute is is found in the &lt;code class=&quot;highlighter-rouge&quot;&gt;post.html&lt;/code&gt; layout in &lt;code class=&quot;highlighter-rouge&quot;&gt;.\_layouts\&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;    {%- if page.author -%}
        • &lt;span class=&quot;nt&quot;&gt;&amp;lt;span&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;itemprop=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;author&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;itemscope&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;itemtype=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://schema.org/Person&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;span&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;p-author h-card&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;itemprop=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;{{ page.author }}&lt;span class=&quot;nt&quot;&gt;&amp;lt;/span&amp;gt;&amp;lt;/span&amp;gt;&lt;/span&gt;
    {%- endif -%}&lt;span class=&quot;nt&quot;&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h1 id=&quot;references&quot;&gt;References:&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://jekyllrb.com/docs/configuration/#front-matter-defaults&quot;&gt;Front Matter Defaults&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;possible-enhancements&quot;&gt;Possible Enhancements:&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://dev.to/m0nica/how-to-add-author-bio-to-posts-in-jekyll-3g1&quot;&gt;Add Author Bio to Site&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/15189008/how-can-i-have-multiple-authors-for-one-post-in-jekyll&quot;&gt;Setup Post Template to Support Multiple Authors&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://jekyllrb.com/docs/configuration/#front-matter-defaults&quot;&gt;Set Default Author for Whole Jekyll Blog&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>David Midlo</name></author><category term="jekyll" /><category term="post" /><category term="front matter" /><summary type="html">Problem: Author should be listed on post in Jekyll.</summary></entry><entry><title type="html">If Time is the Only True Currency, Than NTP is the Only True Treasury</title><link href="https://www.axisux.com/fieldnotes/engineering/infrastructure/2014/06/20/If-Time-is-The-only-true-currency-than-NTP-is-the-only-True-Treasury.html" rel="alternate" type="text/html" title="If Time is the Only True Currency, Than NTP is the Only True Treasury" /><published>2014-06-20T00:00:00-05:00</published><updated>2014-06-20T00:00:00-05:00</updated><id>https://www.axisux.com/fieldnotes/engineering/infrastructure/2014/06/20/If-Time-is-The-only-true-currency-than-NTP-is-the-only-True-Treasury</id><content type="html" xml:base="https://www.axisux.com/fieldnotes/engineering/infrastructure/2014/06/20/If-Time-is-The-only-true-currency-than-NTP-is-the-only-True-Treasury.html">&lt;p&gt;Good timekeeping is essential in enterprise IT infrastructure. If left unattended, inaccurate or out of sync time can cause all sorts of issues. On the mundane side, it can be tough to compare syslog messages when the timestamps can not be trusted. On the more extreme side, with enough drift between clocks could result in a complete work stoppage as users may not be able to authenticate against a directory server to get logged in in the morning.&lt;/p&gt;

&lt;p&gt;Thankfully, Good NTP design is pretty difficult to screw up. Essentially, there are three simple rules to follow in order to get timekeeping right; One, understand the needs and capabilities of the systems that require time services. Two, Define a reliable common time server (or server pool) for all systems to reference. Three, Leverage NTP authentication in any systems that will support it.&lt;/p&gt;

&lt;h2 id=&quot;one-understand-the-capabilities-of-the-systems-that-require-time-services&quot;&gt;One, understand the capabilities of the systems that require time services&lt;/h2&gt;

&lt;p&gt;In a typical enterprise there are any number of systems that require accurate timekeeping.  We IT folk often think of things like directory services requiring Kerberos based authentication, card access systems, remote access services, IPS &amp;amp; IDS log analysis, etc.  Often the simpler things are overlooked; HVAC systems, parking lot lights, even the simple wall clock often use NTP based time services.&lt;/p&gt;

&lt;p&gt;In the past, there has been other timekeeping protocols in use, but fortunately they are now artifacts of history and will be omitted from this discussion.  This allows us to work from a simple assumption:  If a system requires network based time keeping it will do so using NTP.&lt;/p&gt;

&lt;p&gt;Different systems support NTP to various levels, specifically in regard to NTP authentication.  We’ll get into a few attacks involving NTP when we look at rule three, but for now just know that some systems support NTP authentication and some systems ‘claim’ to support NTP authentication.  Most ‘infrastructure’ devices support NTP authentication; L2-L3 equipment, Application Firewalls and Proxies, HVAC systems, etc. In other words, systems that are generally considered to be network ‘appliances’ will typically support NTP authentication.&lt;/p&gt;

&lt;p&gt;For design considerations, there is only one system that stands out.  Microsoft Active Directory.&lt;/p&gt;

&lt;p&gt;Active Directory incorporates NTP in much the same way it has with DNS, DHCP, MIT Kerberos, HPFS Permissions, etc into the Windows ecosystem.  Unfortunately, just like when attempting to integrate Microsoft DNS and BIND, certain issues arise when working towards interoperability.   Here is a quick description from technet describing AD’s usage of NTP authentication:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;em&gt;”Within an AD DS forest, the Windows Time service relies on standard domain security features to enforce the authentication of time data. The security of NTP packets that are sent between a domain member computer and a local domain controller that is acting as a time server is based on shared key authentication. The Windows Time service uses the computer’s Kerberos session key to create authenticated signatures on NTP packets that are sent across the network. NTP packets are not transmitted inside the Net Logon secure channel. Instead, when a computer requests the time from a domain controller in the domain hierarchy, the Windows Time service requires that the time be authenticated. The domain controller then returns the required information in the form of a 64-bit value that has been authenticated with the session key from the Net Logon service. If the returned NTP packet is not signed with the computer’s session key or is signed incorrectly, the time is rejected. All such authentication failures are logged in the Event Log. In this way, the Windows Time service provides security for NTP data in an AD DS forest.”&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;~ &lt;a href=&quot;https://docs.microsoft.com/en-us/windows-server/networking/windows-time-service/how-the-windows-time-service-works&quot;&gt;How the Windows Time Service Works&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Here you can see that instead of using a standard string for the shared-secret, Microsoft uses the Kerberos session ticket for NTP authentication.  It is really an elegant solution, but is unfortunately causes interoperability issues with standard NTP systems. Microsoft has a wonderful write up on their implementation of the (&lt;a href=&quot;https://www.axisux.com/assets/documents/pdfs/%5BMS-SNTP%5D.pdf&quot;&gt;NTP Authentication Extensions&lt;/a&gt;) but further reading reveals no mention of NTP authentication configuration using an external time server leveraging a string as the shared-secret.  Given the impact it has on most organizations, the fact that AD seems to not be interoperable with external services will definitely have an impact on our design.&lt;/p&gt;

&lt;h2 id=&quot;two-define-a-reliable-common-time-server-or-server-pool-for-all-systems-to-reference&quot;&gt;Two, Define a reliable common time server (or server pool) for all systems to reference.&lt;/h2&gt;

&lt;p&gt;Right, this stuff is pretty simple. There is really two ways to approach this;  One, install hardware clocks that reference common NTP servers.  In the US, typically these hardware clocks will point to the two secure NTP servers provided by NIST, ntp-a.boulder.nst.gov and ntp-b.nist.gov.  Two, use existing internal systems as NTP servers for the enterprise.  We will be exploring this second option a bit further.&lt;/p&gt;

&lt;p&gt;Many will simply use Active Directory Domain Controllers as the common time keeping pool within an organization.  Since however AD NTP authentication can not interoperate either as a client or a server with other systems (as it does not provide a mechanism to provide a sting based shared-secret,) it is not suitable to act in a central role in an NTP design as it is especially susceptible to man-in-the-middle attacks.&lt;/p&gt;

&lt;p&gt;Here is an example NTP topology with a consideration of the limitations of Active Directory’s use of NTP authentication:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://www.axisux.com/assets/images/posts/NTP-Architecture.jpg&quot; alt=&quot;NTP Architeture&quot; /&gt;&lt;/p&gt;

&lt;p&gt;NIST actually provides access to NTP authentication services to the general public for free.  &lt;a href=&quot;https://www.nist.gov/pml/time-and-frequency-division/time-services/nist-authenticated-ntp-service&quot;&gt;You can find out how here&lt;/a&gt;.  The two NIST NTP servers that provide authentication are  ntp-a.boulder.nst.gov and ntp-b.nist.gov, the same two servers that most hardware clocks use (that I’ve had experience with anyway.)&lt;/p&gt;

&lt;p&gt;In the design above a Cisco ASA550 and a Cisco Catalyst 4510 as redundant internal NTP servers.  This is because both support NTP authentication natively.  All systems that natively support NTP authentication and are not part of a Windows domain will reference these two nodes for timekeeping, which in turn securely reference NIST servers over the public WAN.  The Windows domain is situated in the rear of this design as it is the weakest link in the security chain.  A way to fortify NTP communications to the windows domain could be to utilize IPSec to tunnel NTP communications  between the Core Nodes and out-of-band management interfaces on the Domain Controllers.  Assuming multiple DCs, this would be easily accomplished in a virtualized environment either by terminating the tunnel at physical interface adjacent to a dedicated virtual switch used for OOB network management traffic, or by implementing a third-party virtual firewall that supports IPSec tunneling such as Cisco’s Nexus 1000v cloud firewall.  The idea is to not secure to a specific domain controller as it adds an unnecessary level of complexity when the PDC Emulator role migrates to a different DC.  Instead sending unsecured NTP through the common secured OOB management network is indifferent to which DC holds the PDC Emulator role.&lt;/p&gt;

&lt;p&gt;Microsoft’s implementation of NTP authentication within a Windows Domain is solid enough to be trusted and it is unfortunate that is isn’t very interoperable.  That being said, there are many benefits to integrate systems with Active Directory aside from secured NTP communications, even OS X, UNIX, and Linux systems.  The rule is, if you can join it to AD you should do so (unless you have an overwhelming reason to not.)&lt;/p&gt;

&lt;h2 id=&quot;three-leverage-ntp-authentication-in-any-systems-that-will-support-it&quot;&gt;Three, Leverage NTP authentication in any systems that will support it.&lt;/h2&gt;

&lt;p&gt;If the small hints of the catastrophe mentioned above are not enough to convince you that NTP can pose a serious risk to your environment if left unmanaged, the Cheshire Cat (from the 2600 community if I’m not mistaken) has written a &lt;a href=&quot;https://www.eecis.udel.edu/~mills/security.html&quot;&gt;nice security analysis of NTP found here.&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;If you’re looking at your NTP design now, I hope this post has pointed out some often unconsidered design issues and helps you to spend time more securely.  I may follow up with a post on device specific configurations; Cisco, HP Procurve L2/L3 device configs, ASA configurations, OS X &amp;amp; Linux configs, and Windows batch, powershell, and group policy scripts and settings.  All of these are easily googled for, so then again, I may not.&lt;/p&gt;

&lt;p&gt;There are also considerations that need to be made regarding time services in virtualized environments, in as far as hypervisor and guest timekeeping.  For a good article regarding timekeeping in Microsoft’s Hyper-V see &lt;a href=&quot;https://blogs.msdn.microsoft.com/virtual_pc_guy/2010/11/19/time-synchronization-in-hyper-v/&quot;&gt;this blog post by Ben Armstrong&lt;/a&gt;, the Hyper-V program manager.  The problems outlined by Ben are applicable not only to hyper-v, but VMware, Citrix, Xen or any other virtualization platform as well.&lt;/p&gt;</content><author><name>David Midlo</name></author><category term="NTP" /><category term="Active Directory" /><category term="Windows Server" /><summary type="html">Good timekeeping is essential in enterprise IT infrastructure. If left unattended, inaccurate or out of sync time can cause all sorts of issues. On the mundane side, it can be tough to compare syslog messages when the timestamps can not be trusted. On the more extreme side, with enough drift between clocks could result in a complete work stoppage as users may not be able to authenticate against a directory server to get logged in in the morning.</summary></entry><entry><title type="html">Powershell for Resuming a Script from Known Last Position</title><link href="https://www.axisux.com/fieldnotes/engineering/infrastructure/2014/06/17/Powershell-for-Resuming-a-Script-from-Known-Last-Position.html" rel="alternate" type="text/html" title="Powershell for Resuming a Script from Known Last Position" /><published>2014-06-17T00:00:00-05:00</published><updated>2014-06-17T00:00:00-05:00</updated><id>https://www.axisux.com/fieldnotes/engineering/infrastructure/2014/06/17/Powershell-for-Resuming-a-Script-from-Known-Last-Position</id><content type="html" xml:base="https://www.axisux.com/fieldnotes/engineering/infrastructure/2014/06/17/Powershell-for-Resuming-a-Script-from-Known-Last-Position.html">&lt;h1 id=&quot;problem&quot;&gt;Problem:&lt;/h1&gt;
&lt;p&gt;I’ve been working on some powershell that will completely automate the user account provisioning process for my organization.  Currently the script is in beta, and being tested at a limited scope with great success.&lt;/p&gt;

&lt;p&gt;There are some other moving parts required to get this off the ground.  When dealing with a directory that has 7500 real users in it, you have to make sure you’re only handling the accounts as much as you have to.  One of the mechanisms of doing that is picking up where you left off even if you stop the script for debugging.  The following is a proof-of-concept script that can be turned into a function or used as a wrapper around any script that is going through a large list using a for-each loop.   I’ve commented the code at each step so you can keep track of what the script is doing and to express some of the thought behind my decisions.   You’ll also notice that you can download this script or view it in a raw format using the links at the top right of script block.&lt;/p&gt;

&lt;h1 id=&quot;solution&quot;&gt;Solution:&lt;/h1&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;c1&quot;&gt;#############################################################################&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;##  ScriptName: last_session.ps1&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;##  author: @dmidlo (twitter)    david@axisux.com&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;## &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;## Purpose:  a Proof of Concept script that stores the current progress of a foreach&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;##   loop to a file to enable the script to resume from where it left off&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;##&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;##&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;## Disclaimer:  No warranty and all that! This is a proof of concept script only! There is no &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;##   error handling or anything that would potentially obscure how this operation is functioning.&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;##   (Except for &quot;write-progress&quot; which is vital to not going insane while waiting for hours for&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;##   a process to complete.)&lt;/span&gt;
 
&lt;span class=&quot;c1&quot;&gt;#######################################################################################&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;## clean up the variables for consecutive runs from ISE&lt;/span&gt;
Import-Module activedirectory
&lt;span class=&quot;nb&quot;&gt;Clear&lt;/span&gt;-Host
&lt;span class=&quot;nv&quot;&gt;$user&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$null&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$users&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$null&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ClixmlUsers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$null&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$rootDN&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$null&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ImportedUserHash&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$null&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$CurrentSessionUserHash&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$null&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#######################################################################################&lt;/span&gt;
 
&lt;span class=&quot;c1&quot;&gt;## Define the OU&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$rootDN&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;OU=Users,DC=your,DC=com&quot;&lt;/span&gt;
 
&lt;span class=&quot;c1&quot;&gt;## Initilize HashTables $importeduserhash is the datasource, $CurrentSessionUserHash is a post-run diagnostics variable&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ImportedUserHash&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; @&lt;span class=&quot;o&quot;&gt;{}&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$CurrentSessionUserHash&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; @&lt;span class=&quot;o&quot;&gt;{}&lt;/span&gt;
 
&lt;span class=&quot;c1&quot;&gt;## Import Previous Runs&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ImportedUserHash&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Import-Clixml&lt;/span&gt; .\USERS.clixml -ErrorAction SilentlyContinue
 
&lt;span class=&quot;c1&quot;&gt;## Get List of Users From Active Directory&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$Users&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; @&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;Get-ADUser&lt;/span&gt; -filter &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; -SearchScope subtree -SearchBase &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$rootDN&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; -Properties sAMAccountName,distinguishedName,homedirectory&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
 
&lt;span class=&quot;c1&quot;&gt;## Setup Variables for Write-Progress&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$users&lt;/span&gt;.Count
&lt;span class=&quot;nv&quot;&gt;$b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$ImportedUserHash&lt;/span&gt;.count
 
&lt;span class=&quot;c1&quot;&gt;## Notify Host of Current Progress Numbers&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;write-host&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;imported completed user count is:&quot;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$b&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;write-host&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Active Directory user count is:&quot;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$a&lt;/span&gt; 
 
&lt;span class=&quot;c1&quot;&gt;## Begin Labor Loop&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;foreach&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$user&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$Users&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;## Check to see if User was completed in a previous run&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ImportedUserHash&lt;/span&gt;.Contains&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$user&lt;/span&gt;.SamAccountName&lt;span class=&quot;o&quot;&gt;)){&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;## Notify Host that user has already been run in a previous session &lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;Write-Host&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$user&lt;/span&gt;.SamAccountName &lt;span class=&quot;s2&quot;&gt;&quot;completed in previous session&quot;&lt;/span&gt; -ForegroundColor Yellow
        &lt;span class=&quot;c1&quot;&gt;## Add to diagnostics variable with value set at &quot;imported from previous session.&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$CurrentSessionUserHash&lt;/span&gt;.add&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$user&lt;/span&gt;.SamAccountName,&lt;span class=&quot;s2&quot;&gt;&quot;Imported From Previous Session&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;## If user has not been run previously, take action now&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;Else&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;## wait just to give the script something to do to waste time for a demo&lt;/span&gt;
            &lt;span class=&quot;nb&quot;&gt;Start-Sleep&lt;/span&gt; -Seconds 3
            &lt;span class=&quot;c1&quot;&gt;## add user completed user to hashtable for export. This should always be the last functinal step in the foreach...&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;$ImportedUserHash&lt;/span&gt;.add&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$user&lt;/span&gt;.SamAccountName,&lt;span class=&quot;nv&quot;&gt;$user&lt;/span&gt;.DistinguishedName&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;## Export hashtable to clixml.  I chose clixml instead of csv for two reasons; one, it imports as the variable as it was &lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;## exported as. Two, it will be less likely to be deleted by some other admin.&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;$ImportedUserHash&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;Export-Clixml&lt;/span&gt; .\USERS.clixml
 
            &lt;span class=&quot;c1&quot;&gt;## add user to diagnostics variable with value set to &quot;current session&quot;&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;$CurrentSessionUserHash&lt;/span&gt;.add&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$user&lt;/span&gt;.SamAccountName,&lt;span class=&quot;s2&quot;&gt;&quot;Current Session&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
 
            &lt;span class=&quot;c1&quot;&gt;## notify host things went well&lt;/span&gt;
            &lt;span class=&quot;nb&quot;&gt;write-host&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$user&lt;/span&gt;.sAMAccountName &lt;span class=&quot;s2&quot;&gt;&quot;has been added to User Hashtable&quot;&lt;/span&gt;-ForegroundColor Green
 
            &lt;span class=&quot;c1&quot;&gt;## +1 to the write-progress count        &lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;$B&lt;/span&gt;++
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
 
    &lt;span class=&quot;c1&quot;&gt;## percent of whole calculator for write-progress&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$b&lt;/span&gt; / &lt;span class=&quot;nv&quot;&gt;$a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; 100
 
    &lt;span class=&quot;c1&quot;&gt;## update progress bar with current statistics.&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;write-progress&lt;/span&gt; -activity Updating -status &lt;span class=&quot;s1&quot;&gt;'Progress-&amp;amp;gt;'&lt;/span&gt; -percentcomplete &lt;span class=&quot;nv&quot;&gt;$c&lt;/span&gt; -currentOperation &lt;span class=&quot;s2&quot;&gt;&quot;Profiles Completed: &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$b&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; of &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$a&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; Percent Complete: &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$c&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; Current Accout: &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$user&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.sAMAccoutname&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;</content><author><name>David Midlo</name></author><category term="Powershell" /><summary type="html">Problem: I’ve been working on some powershell that will completely automate the user account provisioning process for my organization. Currently the script is in beta, and being tested at a limited scope with great success.</summary></entry><entry><title type="html">Modifying DHCP options with Powershell</title><link href="https://www.axisux.com/fieldnotes/engineering/infrastructure/2013/05/19/Modifying-DHCP-Options-With-Powershell.html" rel="alternate" type="text/html" title="Modifying DHCP options with Powershell" /><published>2013-05-19T00:00:00-05:00</published><updated>2013-05-19T00:00:00-05:00</updated><id>https://www.axisux.com/fieldnotes/engineering/infrastructure/2013/05/19/Modifying-DHCP-Options-With-Powershell</id><content type="html" xml:base="https://www.axisux.com/fieldnotes/engineering/infrastructure/2013/05/19/Modifying-DHCP-Options-With-Powershell.html">&lt;h1 id=&quot;problem&quot;&gt;Problem:&lt;/h1&gt;
&lt;p&gt;If you run medium or large network with many sites, you’ll have a lot of DHCP scopes or a lot of DHCP servers because you’ll have a lot of vlans and therefore a lot of subnets. Most of which require DHCP services. Also,  If you’re running a windows domain, you’re using a windows DHCP server, well, because it just makes sense (due to Dynamic DNS updating.)&lt;/p&gt;

&lt;p&gt;We recently virtualized one of our linux based PXE servers and need to update a bunch of scope’s PXE options (66 and 67.)  Here is an example of how to approach the problem using only powershell cmdlets (none of that ‘netsh’ stuff!)&lt;/p&gt;

&lt;p&gt;It is important to note that DHCP stores different options as different types of values, so this will work with ‘string’ type options.  To work with other types of DHCP options the principles outlined here still apply, just be sure your inputs correspond with value type of the DHCP option your working with.&lt;/p&gt;

&lt;h1 id=&quot;solution&quot;&gt;Solution:&lt;/h1&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;c1&quot;&gt;#############################################################################&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#  ScriptName:  Set_DHCP_Options.ps1&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#  Author:  @dmidlo Twitter) david@axisux.com&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#  This is an example of script that collects All authorized DHCP servers &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#  in a windows domain and changes values.  This script also contains an &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#  example of excluding a set of addresses. Read through the comments within&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#  the script for more information.  This is using PXE related options to &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#  illustrate the syntax of the cmdlets, be sure to modify the script to &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#  suite your needs&lt;/span&gt;
 
&lt;span class=&quot;c1&quot;&gt;#### Change this value to PXE server's network location&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ipaddress&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;10.1.0.1&quot;&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# this also can be a FQDN&lt;/span&gt;
 
&lt;span class=&quot;c1&quot;&gt;#### This is the name of the file located on the PXE server the client should look for&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#### if you use a linux based PXE server, often the bootfile name is &quot;pxelinux.0&quot;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#### the present value is if your running a WDS or MDT server for PXE boot.  SCCM does&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#### not recommend the use of boot options for establishing PXE sessions, instead you &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#### would configure broadcast forwarders on your networking equipment to your SCCM&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#### server.&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bootfileName&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;boot\x86\wdsnbp.com&quot;&lt;/span&gt;
 
&lt;span class=&quot;c1&quot;&gt;#### Capture authorized DHCP servers and store them&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$dhcpServers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; Get-DhcpServerInDC
 
&lt;span class=&quot;c1&quot;&gt;#### Begin Labor Loop for each authorized DHCP server in the domain&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;foreach&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$dhcpServer&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$dhcpServers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
 
    &lt;span class=&quot;c1&quot;&gt;# get the scopes from current DHCP server&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$scopes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; Get-DhcpServerv4Scope -ComputerName &lt;span class=&quot;nv&quot;&gt;$dhcpServer&lt;/span&gt;.DnsName
 
    &lt;span class=&quot;c1&quot;&gt;# for each scope in the DHCP server set options PXE options 66 and 67&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;foreach&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$scope&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$scopes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$bootServerValue&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; Get-DhcpServerv4OptionValue -ComputerName &lt;span class=&quot;nv&quot;&gt;$dhcpServer&lt;/span&gt;.DnsName -ScopeId &lt;span class=&quot;nv&quot;&gt;$scope&lt;/span&gt;.ScopeId -OptionId 66
 
        &lt;span class=&quot;c1&quot;&gt;# Exclude any Scope that begins with &quot;10.20&quot;&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;#### DHCP stores these values as strings, so we do the exclusion using string evaluation.&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;#### if you wanted to exclude multipe ranges you would use the '-or' operator with enclosing parentheses&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;#### example (($bootServerValue.Value -notlike &quot;10.20*&quot; ) -or ($bootServerValue.Value -notlike &quot;10.32*&quot; ))&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;#### you could also use &quot;-like&quot; instead of &quot;-notlike&quot; if you wanted to catch just a subset of scopes. Think 'Top-Down' vs 'Bottom-Up'&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$bootServerValue&lt;/span&gt;.Value -notlike &lt;span class=&quot;s2&quot;&gt;&quot;10.20*&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
 
            &lt;span class=&quot;c1&quot;&gt;# Set value 66 with the network location defined above&lt;/span&gt;
            &lt;span class=&quot;nb&quot;&gt;Set&lt;/span&gt;-DhcpServerv4OptionValue -ComputerName &lt;span class=&quot;nv&quot;&gt;$dhcpServer&lt;/span&gt;.DnsName -ScopeId &lt;span class=&quot;nv&quot;&gt;$scope&lt;/span&gt;.ScopeId -OptionId 66 -Value &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$IPadddress&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
 
            &lt;span class=&quot;c1&quot;&gt;# Set value 67 with the bootfile name defined above&lt;/span&gt;
            &lt;span class=&quot;nb&quot;&gt;Set&lt;/span&gt;-DhcpServerv4OptionValue -ComputerName &lt;span class=&quot;nv&quot;&gt;$dhcpServer&lt;/span&gt;.DnsName -ScopeId &lt;span class=&quot;nv&quot;&gt;$scope&lt;/span&gt;.ScopeId -OptionId 67 -Value &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$bootfileName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;</content><author><name>David Midlo</name></author><category term="Powershell" /><category term="Windows Server" /><category term="Active Directory" /><category term="DHCP" /><summary type="html">Problem: If you run medium or large network with many sites, you’ll have a lot of DHCP scopes or a lot of DHCP servers because you’ll have a lot of vlans and therefore a lot of subnets. Most of which require DHCP services. Also, If you’re running a windows domain, you’re using a windows DHCP server, well, because it just makes sense (due to Dynamic DNS updating.)</summary></entry><entry><title type="html">Dual-Delivery: Powershell For Google Apps Mail Forwarding From Exchange</title><link href="https://www.axisux.com/fieldnotes/engineering/infrastructure/2012/12/02/Powershell-for-Google-Apps-Migration-mail-forwarding-from-exchange.html" rel="alternate" type="text/html" title="Dual-Delivery: Powershell For Google Apps Mail Forwarding From Exchange" /><published>2012-12-02T00:00:00-06:00</published><updated>2012-12-02T00:00:00-06:00</updated><id>https://www.axisux.com/fieldnotes/engineering/infrastructure/2012/12/02/Powershell-for-Google-Apps-Migration-mail-forwarding-from-exchange</id><content type="html" xml:base="https://www.axisux.com/fieldnotes/engineering/infrastructure/2012/12/02/Powershell-for-Google-Apps-Migration-mail-forwarding-from-exchange.html">&lt;h1 id=&quot;problem&quot;&gt;Problem:&lt;/h1&gt;
&lt;p&gt;When Setting up Dual-Delivery between an exchange and Google Apps Environment only limited co-existence is possible.  It’s even further away from possibility to syncronize mailbox contents and state between the two environments.&lt;/p&gt;

&lt;p&gt;Within those confines, a limited level of co-existence is possible in as far as dual-delivery.  Dual Delivery configurations strickly apply recieved email, and does not syncronize folder contents, delete/archived state, or anything else.&lt;/p&gt;

&lt;p&gt;This method fits into a larger migration strategy in which an organization is moving to google apps from microsoft exchange and serves as a stop-gap differential to be put in place once GSMME has migrated email, contacts, and calendars to G Suite services.  This stop gap allows a small grace-period to users as they transition to G Suite Services by delievering mail to the respective “duplicate” mailboxes in each environment.&lt;/p&gt;

&lt;p&gt;This method creates a mail contact within the exchange org.  Mail is recieved and delivered first at the exchange mailbox, then forwarded to the G Suite Mailbox via a mail-enabled exchange contact.&lt;/p&gt;

&lt;h1 id=&quot;solution&quot;&gt;Solution:&lt;/h1&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span class=&quot;c1&quot;&gt;### Create Mail contacts for all users within an organization unit and&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;### apply Mail Forwarding to User Mailboxes for Delievery to Exchange&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;### and Google Apps Mail and hide contacts from global address book&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#### David Midlo&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;### Run this from a domain joined computer. Must Have Exchange&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;### management shell installed.&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;### Make sure you have rights to perform required operations &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;### manually within your Active Directory and Exchange Environments.&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;### Import Required Modules. Sometimes script will fail if Exchange&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Snap-in is already loaded, comment out Add-PSSnaping in this event&lt;/span&gt;
import-module ActiveDirectory
Add-PSSnapin Microsoft.Exchange.Management.PowerShell.Admin

&lt;span class=&quot;c1&quot;&gt;### User Defined Variables&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Define Base Disinguished Name and Destination DN for created contacts&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$rootDN&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;OU=HRAccounts,OU=StaffUsers,DC=your,DC=domain,DC=com&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$contactsDN&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;OU=GoogleForwadingContacts,DC=your,DC=domain,DC=com&quot;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;## Define naming convention&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Google root nickname DN for filling contact mail attribute&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$GoogleNickname&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;domain.com.test-google-a.com&quot;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# AD Contact Name prefix for creating contact CN result would be&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#   google.john&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ContactPrefix&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;google&quot;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;### Define Active Directory Attributes to Act on. &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Remove empty entries from the Get-AdUser's line 'Properties' and 'select' flags&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# ObjectGuid and CN are added as reference for CSV output&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$Attribute01&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;sAMAccountName&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$Attribute02&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;mail&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$Attribute03&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;ObjectGUID&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$Attribute04&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;cn&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$Attribute05&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;proxyAddress&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$Attribute06&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;targetAddress&quot;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#######################################################################&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Reset Arrays for multiple runs&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ADUsers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$null&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$NewContacts&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$null&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Capture Active Directory Users w/ attributes and place into an array&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Remeber to remove undefined attributes from this line&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;Get-ADUser&lt;/span&gt; -Filter &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; -SearchBase &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$rootDN&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; -Properties &lt;span class=&quot;nv&quot;&gt;$Attribute01&lt;/span&gt;,&lt;span class=&quot;nv&quot;&gt;$Attribute02&lt;/span&gt;,&lt;span class=&quot;nv&quot;&gt;$Attribute03&lt;/span&gt;,&lt;span class=&quot;nv&quot;&gt;$Attribute04&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$Attribute01&lt;/span&gt;,&lt;span class=&quot;nv&quot;&gt;$Attribute02&lt;/span&gt;,&lt;span class=&quot;nv&quot;&gt;$Attribute03&lt;/span&gt;,&lt;span class=&quot;nv&quot;&gt;$Attribute04&lt;/span&gt; | &lt;span class=&quot;k&quot;&gt;ForEach&lt;/span&gt;-Object &lt;span class=&quot;o&quot;&gt;{[&lt;/span&gt;array]&lt;span class=&quot;nv&quot;&gt;$ADUsers&lt;/span&gt; +&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; 

&lt;span class=&quot;c1&quot;&gt;# Create contacts for each entry in array&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;foreach&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ADUser&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$ADUsers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;# Variables Defined by Array $ADUsers&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$UserAccount&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$ADUser&lt;/span&gt;.sAMAccountName
  &lt;span class=&quot;nv&quot;&gt;$Mail&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$ADUser&lt;/span&gt;.mail 

  &lt;span class=&quot;c1&quot;&gt;# Create contact email based on AD user's current email&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$ContactName&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ContactPrefix&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$UserAccount&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$Name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$Mail&lt;/span&gt;.Split&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;@&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)[&lt;/span&gt;0]
  &lt;span class=&quot;nv&quot;&gt;$ForwardingEmail&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Name&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$GoogleNickname&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;# Action Cmdlets&lt;/span&gt;
  New-MailContact -ExternalEmailAddress &lt;span class=&quot;nv&quot;&gt;$ForwardingEmail&lt;/span&gt; -Name &lt;span class=&quot;nv&quot;&gt;$ContactName&lt;/span&gt; -OrganizationalUnit &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$contactsDN&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;Set&lt;/span&gt;-MailContact -Identity &lt;span class=&quot;nv&quot;&gt;$ForwardingEmail&lt;/span&gt; -HiddenFromAddressListsEnabled &lt;span class=&quot;nv&quot;&gt;$true&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;Set&lt;/span&gt;-Mailbox -Identity &lt;span class=&quot;nv&quot;&gt;$UserAccount&lt;/span&gt; -ForwardingAddress &lt;span class=&quot;nv&quot;&gt;$ForwardingEmail&lt;/span&gt; -DeliverToMailboxAndForward &lt;span class=&quot;nv&quot;&gt;$true&lt;/span&gt;

  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; 

&lt;span class=&quot;c1&quot;&gt;# Collect Contacts from $contactsDN&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;Get-ADObject&lt;/span&gt; -LDAPFilter &lt;span class=&quot;s2&quot;&gt;&quot;objectClass=Contact&quot;&lt;/span&gt; -SearchBase &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$contactsDN&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; -Properties &lt;span class=&quot;nv&quot;&gt;$Attribute04&lt;/span&gt;,&lt;span class=&quot;nv&quot;&gt;$Attribute02&lt;/span&gt;,&lt;span class=&quot;nv&quot;&gt;$Attribute05&lt;/span&gt;,&lt;span class=&quot;nv&quot;&gt;$Attribute06&lt;/span&gt;,&lt;span class=&quot;nv&quot;&gt;$Attribute03&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$Attribute04&lt;/span&gt;,&lt;span class=&quot;nv&quot;&gt;$Attribute02&lt;/span&gt;,&lt;span class=&quot;nv&quot;&gt;$Attribute05&lt;/span&gt;,&lt;span class=&quot;nv&quot;&gt;$Attribute06&lt;/span&gt;,&lt;span class=&quot;nv&quot;&gt;$Attribute03&lt;/span&gt; | &lt;span class=&quot;k&quot;&gt;ForEach&lt;/span&gt;-Object &lt;span class=&quot;o&quot;&gt;{[&lt;/span&gt;array]&lt;span class=&quot;nv&quot;&gt;$NewContacts&lt;/span&gt; +&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

 # Export CSVs
 &lt;span class=&quot;nv&quot;&gt;$ADUsers&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;Export-Csv &lt;/span&gt;ADUsers.csv
 &lt;span class=&quot;nv&quot;&gt;$NewContacts&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;Export-Csv &lt;/span&gt;ForwardingContacts.csv&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h1 id=&quot;additonal-notes&quot;&gt;Additonal Notes:&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;Other possible solutions might include scripted delgation, but that would have many considerations to unpack.&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;references&quot;&gt;References:&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://support.google.com/a/answer/180898?hl=en&quot;&gt;Migrate From Microsoft Exchange&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;possible-enhancements&quot;&gt;Possible Enhancements:&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://mymicrosoftexchange.wordpress.com/2015/06/21/how-to-configure-mail-flow-coexistence-between-gapps-and-o365-using-internal-relay-domains-and-mail-users/&quot;&gt;SMTP Coesxistance as a Possiblity&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://community.spiceworks.com/how_to/38537-ms-exchange-and-google-apps-split-delivery-for-single-domain-name-k-12-school-sample-shown&quot;&gt;Single Domain Split Delivery&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>David Midlo</name></author><category term="Exchange Server" /><category term="Powershell" /><category term="Google Apps" /><category term="Dual-Delivery" /><summary type="html">Problem: When Setting up Dual-Delivery between an exchange and Google Apps Environment only limited co-existence is possible. It’s even further away from possibility to syncronize mailbox contents and state between the two environments.</summary></entry></feed>